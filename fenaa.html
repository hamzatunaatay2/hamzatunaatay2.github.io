<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galeri Baronu v7: Racon ve Gece</title>
    <style>
        :root { --neon: #00f2ff; --pink: #ff007f; --gold: #ffd700; --dark: #050505; }
        body { margin: 0; background: #000; color: #fff; font-family: 'Courier New', monospace; overflow: hidden; }
        
        /* HUD */
        #hud { position: fixed; top: 0; width: 100%; height: 50px; display: flex; align-items: center; justify-content: space-around; background: #000; z-index: 1000; border-bottom: 2px solid #333; }
        .stat span { color: var(--gold); font-weight: bold; }

        #game { display: grid; grid-template-columns: 320px 1fr; height: 100vh; padding-top: 50px; }
        #sidebar { background: var(--dark); border-right: 2px solid #222; padding: 15px; z-index: 500; overflow-y: auto; }
        
        .btn { background: #111; border: 1px solid #333; color: #ccc; padding: 14px; width: 100%; margin-bottom: 10px; cursor: pointer; text-align: left; font-weight: bold; text-transform: uppercase; }
        .btn:hover { border-color: var(--neon); color: #fff; background: #181818; }
        .btn.danger { border-color: var(--pink); color: var(--pink); }

        #viewport { position: relative; background: #000; overflow: hidden; }
        canvas { width: 100%; height: 100%; display: block; }
        
        #speedo { position: absolute; bottom: 25px; left: 25px; font-size: 45px; font-weight: 900; color: #fff; font-style: italic; z-index: 100; text-shadow: 2px 2px 0 var(--pink); }

        /* TELEFON - iBaron 15 */
        #phone { position: fixed; bottom: -600px; right: 20px; width: 280px; height: 500px; background: #000; border: 5px solid #222; border-radius: 35px; transition: 0.6s cubic-bezier(0.1, 0.7, 1.0, 0.1); z-index: 2000; padding: 20px; box-shadow: 0 0 50px #000; }
        #phone.active { bottom: 20px; }
        .app-screen { display: none; height: 100%; flex-direction: column; }
        .app-screen.active { display: flex; }
        .app-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 40px; }
        .app-icon { background: #111; padding: 20px; border-radius: 20px; text-align: center; font-size: 30px; cursor: pointer; border: 1px solid #222; }
        .app-icon:hover { border-color: var(--gold); }

        /* Ã–ZEL EFEKT - SEX MODE */
        #action-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: none; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        #action-overlay.active { display: flex; animation: pulse 0.5s infinite; }
        @keyframes pulse { 0% { background: #000; } 50% { background: #100; } 100% { background: #000; } }

        #office-layer { position: absolute; inset: 0; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 10; }
        .dialog-box { background: #111; color: #fff; padding: 30px; border: 2px solid var(--gold); width: 80%; max-width: 450px; text-align: center; box-shadow: 0 0 20px rgba(255,215,0,0.2); }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div id="hud">
    <div class="stat">KASA: <span id="m-val">0</span>â‚º</div>
    <div class="stat">RACON: <span id="r-val">0</span></div>
    <div class="stat">DURUM: <span id="f-status">BEKAR</span></div>
</div>

<div id="game">
    <div id="sidebar">
        <h2 style="color:var(--gold); margin-bottom:20px; border-bottom:1px solid #333;">BARON KONSEYÄ°</h2>
        <button class="btn" onclick="showOffice()">ğŸ¤ RACON KES (TÄ°CARET)</button>
        <button class="btn" onclick="startDrive()">ğŸï¸ PÄ°YASA YAP (SÃœRÃœÅ)</button>
        <button class="btn danger" onclick="goMosque()">ğŸ•Œ CUMA NAMAZI (Ä°BADET)</button>
        <button class="btn" onclick="togglePhone()">ğŸ“± TELEFONU AÃ‡</button>
        <div id="garage-list" style="margin-top:30px;"></div>
    </div>

    <div id="viewport">
        <canvas id="stage"></canvas>
        <div id="speedo" class="hidden">0 KM/H</div>
        
        <div id="office-layer">
            <div class="dialog-box">
                <div id="dialog-text">MÃ¼ÅŸteri bekleniyor...</div>
                <div id="trade-actions" style="margin-top:25px;"></div>
            </div>
        </div>
    </div>
</div>

<div id="action-overlay">
    <h1 style="color:var(--pink); font-size:50px;">ğŸ”¥</h1>
    <h2 id="action-text" style="color:#fff; text-transform:uppercase;">Ã–ZEL ANLAR...</h2>
    <p style="color:#666;">( Baronun stresi atÄ±lÄ±yor... )</p>
</div>

<div id="phone">
    <div class="app-screen active" id="phone-home">
        <div style="text-align:center; font-size:12px; color:#444;">iBaron - Åifreli Hat</div>
        <div class="app-grid">
            <div class="app-icon" onclick="openApp('family')">ğŸ’</div>
            <div class="app-icon" onclick="openApp('bed')">ğŸ”¥</div>
            <div class="app-icon" onclick="alert('KayÄ±t dÄ±ÅŸÄ± para aktarÄ±lÄ±yor...')">ğŸ¦</div>
            <div class="app-icon" onclick="togglePhone()">âŒ</div>
        </div>
    </div>

    <div class="app-screen" id="app-family">
        <button onclick="openApp('main')" style="background:none; color:var(--gold); border:none; cursor:pointer;">[ GERÄ° ]</button>
        <h3 style="text-align:center; color:var(--gold);">AÄ°LE KONSEYÄ°</h3>
        <p id="family-msg" style="font-size:14px; text-align:center; line-height:1.6;"></p>
        <div id="family-btn-area"></div>
    </div>

    <div class="app-screen" id="app-bed">
        <button onclick="openApp('main')" style="background:none; color:var(--pink); border:none; cursor:pointer;">[ GERÄ° ]</button>
        <h3 style="text-align:center;">YATAK ODASI</h3>
        <div id="bed-actions" style="display:flex; flex-direction:column; gap:10px;">
            <p style="text-align:center; color:#555;">Buralar henÃ¼z Ä±ssÄ±z baron...</p>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
    let state = {
        money: 2000000, rep: 100, garage: [], fLevel: 0,
        fNames: ["TEK TABANCA", "SÃ–Z KESÄ°LDÄ°", "NÄ°ÅAN ATILDI", "EVLÄ° / REÄ°S", "BABA"],
        fCosts: [100000, 300000, 700000, 1500000, 3000000]
    };

    function updateUI() {
        document.getElementById('m-val').innerText = state.money.toLocaleString();
        document.getElementById('r-val').innerText = state.rep;
        document.getElementById('f-status').innerText = state.fNames[state.fLevel];
        const gl = document.getElementById('garage-list');
        gl.innerHTML = "<h4 style='color:#444'>GARAJDAKÄ° MAKÄ°NELER</h4>";
        state.garage.forEach((c, i) => {
            gl.innerHTML += `<div style="background:#0a0a0a; padding:10px; border:1px solid #222; margin-bottom:5px; display:flex; justify-content:space-between; font-size:11px;"><span>${c.name}</span> <button style="background:var(--gold); border:none; cursor:pointer;" onclick="sellCar(${i})">SAT</button></div>`;
        });
    }

    function togglePhone() { document.getElementById('phone').classList.toggle('active'); }
    
    function openApp(app) {
        document.querySelectorAll('.app-screen').forEach(s => s.classList.remove('active'));
        if(app === 'main') document.getElementById('phone-home').classList.add('active');
        if(app === 'family') { document.getElementById('app-family').classList.add('active'); drawFamily(); }
        if(app === 'bed') { document.getElementById('app-bed').classList.add('active'); drawBed(); }
    }

    function drawFamily() {
        const msg = document.getElementById('family-msg');
        const area = document.getElementById('family-btn-area');
        const d = [
            "YalnÄ±zlÄ±k Allaha mahsus baron. Sana bir hanÄ±m aÄŸa lazÄ±m.",
            "SÃ¶zÃ¼ kestik, raconumuzu koyduk. Åimdi takÄ±larÄ± dizme vakti.",
            "NiÅŸan ÅŸanÄ±na yakÄ±ÅŸÄ±r olmalÄ±. Åehrin tapusunu Ã¼stÃ¼ne yapalÄ±m mÄ±?",
            "ArtÄ±k evlisin reis. Bu ÅŸehri beraber yÃ¶neteceksiniz.",
            "Veliaht yolda! BaronluÄŸun nesli tÃ¼kenmeyecek."
        ];
        msg.innerText = d[state.fLevel] || "Zirvedesin!";
        area.innerHTML = state.fLevel < 4 ? `<button class="btn" style="border-color:var(--gold)" onclick="upgradeFamily()">ADIM AT (${state.fCosts[state.fLevel].toLocaleString()}â‚º)</button>` : "";
    }

    function upgradeFamily() {
        if(state.money >= state.fCosts[state.fLevel]) {
            state.money -= state.fCosts[state.fLevel];
            state.fLevel++;
            state.rep += 50;
            updateUI(); drawFamily();
            alert("Raconumuz yÃ¼rÃ¼yor, ailemiz bÃ¼yÃ¼yor!");
        } else alert("Kasa boÅŸ reis, Ã¶nce para yap!");
    }

    function drawBed() {
        const area = document.getElementById('bed-actions');
        if(state.fLevel >= 3) {
            area.innerHTML = `
                <button class="btn" style="border-color:var(--pink)" onclick="startAction('EÅŸinle fÄ±rtÄ±nalÄ± anlar...')">ğŸ˜ˆ EÅÄ°NLE Ã–ZEL VAKÄ°T</button>
                <button class="btn" onclick="startAction('SÄ±nÄ±rlar zorlanÄ±yor...')">ğŸ”¥ SEXTAPE (GÄ°ZLÄ°)</button>
            `;
        } else {
            area.innerHTML = `<p style="text-align:center; color:var(--pink);">Ã–nce bir nikah kÄ±y da gÃ¶relim baron!</p>`;
        }
    }

    function startAction(txt) {
        const overlay = document.getElementById('action-overlay');
        document.getElementById('action-text').innerText = txt;
        overlay.classList.add('active');
        setTimeout(() => {
            overlay.classList.remove('active');
            state.rep += 20;
            updateUI();
            alert("Baronun keyfi yerine geldi, itibarÄ±n arttÄ±.");
        }, 3000);
    }

    function goMosque() {
        alert("Ä°mam: 'HoÅŸ geldin baron. DÃ¼nya malÄ± dÃ¼nyada kalÄ±r ama itibar baki.' Namaz kÄ±lÄ±ndÄ±, ruhun dinlendi.");
        state.rep += 30;
        updateUI();
    }

    function showOffice() { isDriving = false; document.getElementById('office-layer').classList.remove('hidden'); genCustomer(); }
    
    function genCustomer() {
        const cars = ["KARA E30", "ZALIM ÅAHÄ°N", "MAFYA G63", "DÄ°RÄ° S2000"];
        const name = cars[Math.floor(Math.random()*cars.length)];
        const p = 300000 + Math.floor(Math.random()*2000000);
        document.getElementById('dialog-text').innerText = `Selamun AleykÃ¼m Reis. ÅÃ¶yle bir ${name} var, ciÄŸerini bilirim. ${p.toLocaleString()}â‚º'ye el sÄ±kÄ±ÅŸalÄ±m mÄ±?`;
        document.getElementById('trade-actions').innerHTML = `
            <button class="btn" onclick="buyCar('${name}', ${p})">Ã‡Ã–ZELÄ°M (AL)</button>
            <button class="btn danger" onclick="genCustomer()">YOL AL (KOV)</button>
        `;
    }

    function buyCar(n, p) {
        if(state.money >= p) { state.money -= p; state.garage.push({name:n, price:p}); updateUI(); alert("HayÄ±rlÄ± olsun reis, anahtar cebinde."); }
        else alert("Cebin boÅŸ baron, piyasada rezil etme bizi!");
    }

    function sellCar(i) {
        const sp = state.garage[i].price * 1.3;
        state.money += sp; state.rep += 10; state.garage.splice(i, 1); updateUI();
        alert("MalÄ± okuttuk, parayÄ± kasaya koyduk!");
    }

    // --- 3D SÄ°STEM ---
    let scene, camera, renderer, player, isDriving = false;
    let speed = 0, angle = 0, velocity = {x:0, z:0}, keys = {};

    function init3D() {
        scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000000);
        scene.fog = new THREE.Fog(0x000000, 10, 120);

        camera = new THREE.PerspectiveCamera(60, (window.innerWidth-320)/window.innerHeight, 0.1, 1000);
        renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('stage'), antialias: true });
        renderer.setSize(window.innerWidth - 320, window.innerHeight);

        scene.add(new THREE.AmbientLight(0xffffff, 0.1));
        
        // ZEMÄ°N (KaranlÄ±k Asfalt)
        const ground = new THREE.Mesh(new THREE.PlaneGeometry(3000, 3000), new THREE.MeshStandardMaterial({color: 0x050505}));
        ground.rotation.x = -Math.PI/2;
        scene.add(ground);

        // ÅEHÄ°R VE LAMBALAR
        for(let i=0; i<100; i++) {
            const z = (i-50) * 40;
            // Lambalar
            const p = new THREE.Mesh(new THREE.CylinderGeometry(0.1, 0.1, 8), new THREE.MeshStandardMaterial({color:0x222}));
            p.position.set(15, 4, z);
            scene.add(p);
            const l = new THREE.PointLight(0xffaa00, 1.5, 35);
            l.position.set(15, 8, z);
            scene.add(l);

            // Binalar (KaranlÄ±k SilÃ¼etler)
            const h = 10 + Math.random()*40;
            const b = new THREE.Mesh(new THREE.BoxGeometry(15, h, 15), new THREE.MeshStandardMaterial({color: 0x080808}));
            const bx = (Math.random() > 0.5 ? 1 : -1) * (30 + Math.random()*50);
            b.position.set(bx, h/2, z);
            scene.add(b);
        }

        // BARON ARABASI
        player = new THREE.Group();
        const body = new THREE.Mesh(new THREE.BoxGeometry(2.4, 0.9, 5), new THREE.MeshStandardMaterial({color: 0x000, metalness: 1, roughness: 0.1}));
        body.position.y = 0.7;
        player.add(body);
        
        // Farlar
        const createFar = (x) => {
            const f = new THREE.SpotLight(0xffffff, 3, 70, 0.6, 0.5);
            f.position.set(x, 0.7, 2.5);
            f.target.position.set(x, 0, 15);
            player.add(f); player.add(f.target);
        };
        createFar(-0.9); createFar(0.9);

        scene.add(player);

        window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
        window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);
        loop();
    }

    function startDrive() {
        if(state.garage.length === 0) return alert("Yaya mÄ± gezeceksin baron? Ã–nce araba al!");
        isDriving = true;
        document.getElementById('office-layer').classList.add('hidden');
        document.getElementById('speedo').classList.remove('hidden');
    }

    function loop() {
        requestAnimationFrame(loop);
        if(isDriving) {
            if(keys['w']) speed += 0.03; else if(keys['s']) speed -= 0.04; else speed *= 0.97;
            speed = Math.max(Math.min(speed, 2.0), -0.5);

            if(Math.abs(speed) > 0.05) {
                const turn = 0.05 * (speed > 1 ? 0.7 : 1);
                if(keys['a']) angle += turn; if(keys['d']) angle -= turn;
            }

            velocity.x = Math.sin(angle) * speed;
            velocity.z = Math.cos(angle) * speed;
            player.position.x += velocity.x;
            player.position.z += velocity.z;
            player.rotation.y = angle;
            player.rotation.z = -velocity.x * 0.2; // Sert dÃ¶nÃ¼ÅŸte yatma

            camera.position.set(player.position.x - Math.sin(angle)*15, 7, player.position.z - Math.cos(angle)*15);
            camera.lookAt(player.position);
            document.getElementById('speedo').innerText = Math.floor(Math.abs(speed)*131) + " KM/H";
        }
        renderer.render(scene, camera);
    }

    init3D(); updateUI();
</script>
</body>
</html>
