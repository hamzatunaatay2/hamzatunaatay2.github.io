<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galeri Tycoon: SÃ¼rÃ¼ÅŸ Modu!</title>
<style>
    :root { --bg: #0f0f0f; --card: #1a1a1a; --gold: #ffd700; --red: #ff4d4d; --green: #2ecc71; --blue: #3498db; }
    body { margin: 0; background: var(--bg); color: #fff; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    
    .top-bar { background: #000; padding: 15px; display: flex; justify-content: space-around; border-bottom: 2px solid #333; font-weight: bold; }
    .bar-wrap { width: 60px; height: 8px; background: #333; border-radius: 4px; display: inline-block; margin-left: 5px; }
    .bar-fill { height: 100%; transition: 0.3s; }

    .container { flex: 1; display: grid; grid-template-columns: 200px 1fr 280px; gap: 10px; padding: 10px; overflow: hidden; }

    .menu { display: flex; flex-direction: column; gap: 10px; }
    .nav-btn { background: var(--card); border: 1px solid #444; color: #fff; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; }
    .nav-btn.active { background: var(--blue); border-color: #fff; }

    .stage { background: var(--card); border-radius: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid #333; position: relative; padding: 20px; }
    .npc-img { font-size: 5em; margin-bottom: 10px; }
    .bubble { background: #222; padding: 15px; border-radius: 10px; text-align: center; border: 1px solid #444; margin-bottom: 20px; }

    .sidebar { background: var(--card); border-radius: 15px; padding: 15px; border: 1px solid #333; }
    .car-box { background: #000; height: 120px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 4em; border: 1px dashed #555; margin: 10px 0; }

    .action-btn { background: var(--green); color: #000; border: none; padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; margin-bottom: 8px; }
    .btn-blue { background: var(--blue); color: #fff; }
    .btn-red { background: var(--red); color: #fff; }

    /* SÃœRÃœÅ KANVASI */
    #drive-canvas { background: #333; border: 4px solid #555; display: none; border-radius: 10px; cursor: crosshair; }
</style>
</head>
<body>

    <div class="top-bar">
        <div>ğŸ’° <span id="money" style="color:var(--green)">300,000</span></div>
        <div>ğŸ• <div class="bar-wrap"><div id="hunger-bar" class="bar-fill" style="background:var(--red); width:20%"></div></div></div>
        <div>ğŸ•Œ <div class="bar-wrap"><div id="faith-bar" class="bar-fill" style="background:var(--green); width:50%"></div></div></div>
        <div style="color:var(--blue)">ğŸ“… <span id="day-text">Pzt</span></div>
    </div>

    <div class="container">
        <div class="menu">
            <button class="nav-btn active" id="btn-galeri" onclick="changeLoc('galeri')">ğŸ¢ Galeri</button>
            <button class="nav-btn" id="btn-mahalle" onclick="changeLoc('mahalle')">ğŸ˜ï¸ Mahalle</button>
            <button class="nav-btn" id="btn-sanayi" onclick="changeLoc('sanayi')">ğŸ”§ Sanayi</button>
            <button class="action-btn btn-red" style="margin-top:auto" onclick="endDay()">ğŸŒ™ GÃ¼nÃ¼ Bitir</button>
        </div>

        <div class="stage" id="main-stage">
            <div id="npc-avatar" class="npc-img">ğŸ¤µ</div>
            <h2 id="npc-name">Galerici Mahmut</h2>
            <div class="bubble" id="npc-talk">"SÃ¼rÃ¼ÅŸ testi yaparsan fiyat artar!"</div>
            
            <canvas id="drive-canvas" width="400" height="400"></canvas>

            <div id="action-area" style="width: 100%; max-width: 300px;"></div>
        </div>

        <div class="sidebar">
            <input type="text" id="gal-name-input" value="TUNA GALERÄ°" style="width:100%; background:none; border:1px solid #444; color:gold; text-align:center; padding:5px; margin-bottom:10px;">
            <div class="car-box" id="car-icon">ğŸ¢</div>
            <h3 id="car-name" style="text-align:center; margin:5px 0">ARAÃ‡ YOK</h3>
            <p id="car-price" style="text-align:center; color:#888;">DeÄŸer: -</p>
            <div id="main-ctrl">
                <button class="action-btn btn-blue" onclick="searchCar()">ğŸš— Araba Ara</button>
            </div>
        </div>
    </div>

<script>
    const cars = [
        {n:"TofaÅŸ Åahin", p:250000, i:"ğŸš—"}, {n:"Fiat Egea", p:900000, i:"ğŸš™"},
        {n:"BMW M4", p:6000000, i:"ğŸï¸"}, {n:"Mercedes G63", p:16000000, i:"ğŸšœ"}
    ];

    let state = { money: 300000, hunger: 20, faith: 50, day: 0, loc: 'galeri', car: null, tempCar: null, tempPrice: 0 };
    let isDriving = false;

    // SÃœRÃœÅ MODU DEÄÄ°ÅKENLERÄ°
    const canvas = document.getElementById('drive-canvas');
    const ctx = canvas.getContext('2d');
    let carX = 185, carY = 300, score = 0;
    let obstacles = [];

    function changeLoc(loc) {
        if(isDriving) return;
        state.loc = loc;
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + loc).classList.add('active');
        const area = document.getElementById('action-area');
        area.innerHTML = "";

        if(loc === 'galeri') {
            setNPC("ğŸ¤µ", "Galerici Mahmut", "Araba burda, sÃ¼rÃ¼ÅŸe hazÄ±r mÄ±sÄ±n?");
        } else if(loc === 'mahalle') {
            setNPC("ğŸ‘³", "HacÄ± Abi", "Huzur burada evlat.");
            area.innerHTML = `<button class="action-btn" style="background:var(--gold)" onclick="pray()">ğŸ•Œ Namaz KÄ±l</button>
                              <button class="action-btn btn-blue" onclick="eat()">ğŸ›’ Market</button>`;
        } else if(loc === 'sanayi') {
            setNPC("ğŸ‘¨â€ğŸ”§", "Usta Nuri", "Getir modifiye yapalÄ±m.");
            if(state.car) area.innerHTML = `<button class="action-btn btn-blue" onclick="mod()">ğŸ› ï¸ Modifiye (-â‚º100k)</button>`;
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('money').innerText = state.money.toLocaleString();
        document.getElementById('hunger-bar').style.width = state.hunger + "%";
        document.getElementById('faith-bar').style.width = state.faith + "%";
        document.getElementById('day-text').innerText = ["Pzt", "Sal", "Ã‡ar", "Per", "Cum", "Cmt", "Paz"][state.day];

        const ctrl = document.getElementById('main-ctrl');
        if(state.car) {
            document.getElementById('car-icon').innerText = state.car.i;
            document.getElementById('car-name').innerText = state.car.n;
            document.getElementById('car-price').innerText = "DeÄŸer: â‚º" + state.car.p.toLocaleString();
            ctrl.innerHTML = `<button class="action-btn" style="background:var(--gold)" onclick="startDrive()">ğŸ SÃ¼rÃ¼ÅŸ Testi Yap</button>
                              <button class="action-btn btn-blue" onclick="sellStart()">ğŸ’° MÃ¼ÅŸteri Bul</button>`;
        } else {
            document.getElementById('car-icon').innerText = "ğŸ¢";
            document.getElementById('car-name').innerText = "ARAÃ‡ YOK";
            ctrl.innerHTML = `<button class="action-btn btn-blue" onclick="searchCar()">ğŸš— Araba Ara</button>`;
        }
    }

    // --- SÃœRÃœÅ MODU MANTIK ---
    function startDrive() {
        isDriving = true;
        canvas.style.display = "block";
        document.getElementById('npc-avatar').style.display = "none";
        document.getElementById('npc-talk').innerText = "WASD ile sÃ¼r! AltÄ±nlarÄ± topla, engellerden kaÃ§!";
        document.getElementById('action-area').style.display = "none";
        score = 0; obstacles = []; carX = 185;
        driveLoop();
    }

    function driveLoop() {
        if(!isDriving) return;
        ctx.fillStyle = "#333";
        ctx.fillRect(0,0,400,400);
        
        // Yol Ã§izgileri
        ctx.strokeStyle = "#fff"; ctx.setLineDash([20, 20]);
        ctx.beginPath(); ctx.moveTo(200, 0); ctx.lineTo(200, 400); ctx.stroke();

        // Araba (Oyuncu)
        ctx.font = "30px Arial";
        ctx.fillText(state.car.i, carX, carY);

        // Engeller ve Paralar
        if(Math.random() < 0.05) obstacles.push({x: Math.random()*370, y: -50, t: Math.random() > 0.3 ? "ğŸš§" : "ğŸ’°"});

        obstacles.forEach((o, index) => {
            o.y += 5;
            ctx.fillText(o.t, o.x, o.y);
            
            // Ã‡arpÄ±ÅŸma
            if(Math.abs(o.x - carX) < 25 && Math.abs(o.y - carY) < 25) {
                if(o.t === "ğŸ’°") { score += 5000; obstacles.splice(index, 1); }
                else { score -= 10000; obstacles.splice(index, 1); }
            }
            if(o.y > 400) obstacles.splice(index, 1);
        });

        if(score < -50000 || score > 100000 || Math.random() < 0.002) finishDrive();
        else requestAnimationFrame(driveLoop);
    }

    function finishDrive() {
        isDriving = false;
        canvas.style.display = "none";
        document.getElementById('npc-avatar').style.display = "block";
        document.getElementById('action-area').style.display = "block";
        state.car.p += score;
        if(state.car.p < 10000) state.car.p = 10000;
        alert("SÃ¼rÃ¼ÅŸ bitti! Araba deÄŸeri " + (score >= 0 ? "arttÄ±: " : "dÃ¼ÅŸtÃ¼: ") + "â‚º" + Math.abs(score).toLocaleString());
        changeLoc('galeri');
    }

    window.addEventListener('keydown', (e) => {
        if(!isDriving) return;
        if(e.key === "a" || e.key === "ArrowLeft") carX -= 15;
        if(e.key === "d" || e.key === "ArrowRight") carX += 15;
        if(carX < 0) carX = 0; if(carX > 370) carX = 370;
    });

    // --- TEMEL FONKSÄ°YONLAR ---
    function searchCar() {
        let c = cars[Math.floor(Math.random()*cars.length)];
        state.tempCar = c; state.tempPrice = Math.floor(c.p * 0.95);
        setNPC("ğŸ‘¤", "SatÄ±cÄ±", `${c.n} iÃ§in â‚º${state.tempPrice.toLocaleString()} istiyorum.`);
        document.getElementById('action-area').innerHTML = `<button class="action-btn" onclick="buyConfirm()">âœ… SatÄ±n Al</button>`;
    }

    function buyConfirm() {
        if(state.money >= state.tempPrice) {
            state.money -= state.tempPrice; state.car = state.tempCar; changeLoc('galeri');
        } else alert("Para yetmiyor!");
    }

    function sellStart() {
        let p = Math.floor(state.car.p * (0.9 + Math.random() * 0.3));
        state.tempPrice = p;
        setNPC("ğŸ¤µ", "MÃ¼ÅŸteri", `Bu araca â‚º${p.toLocaleString()} nakit veririm.`);
        document.getElementById('action-area').innerHTML = `<button class="action-btn" onclick="sellConfirm()">ğŸ¤ SattÄ±m</button>`;
    }

    function sellConfirm() { state.money += state.tempPrice; state.car = null; changeLoc('galeri'); }
    function setNPC(i, n, t) { document.getElementById('npc-avatar').innerText = i; document.getElementById('npc-name').innerText = n; document.getElementById('npc-talk').innerText = `"${t}"`; }
    function pray() { state.faith = 100; alert("Ä°man doldu."); updateUI(); }
    function eat() { if(state.money >= 2000) { state.money -= 2000; state.hunger = 0; updateUI(); } }
    function mod() { state.money -= 100000; state.car.p += 250000; alert("Usta fena yaptÄ±!"); updateUI(); }
    function endDay() { state.day++; if(state.day > 6) state.day = 0; state.hunger += 20; changeLoc('galeri'); }

    updateUI();
</script>
</body>
</html>
