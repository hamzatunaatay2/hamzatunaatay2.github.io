<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Halvior AI - Coder Edition</title>
    <style>
        :root { --bg: #050507; --panel: #111114; --accent: #00ff9d; --text: #e0e0e0; --error: #ff4d4d; }
        body { font-family: 'Fira Code', 'Courier New', monospace; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }
        
        #app { width: 95%; max-width: 700px; height: 90vh; background: var(--panel); border: 1px solid #222; border-radius: 15px; display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(0, 255, 157, 0.1); }
        
        .header { padding: 15px 25px; background: #1a1a1e; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; }
        .header h2 { margin: 0; font-size: 1rem; color: var(--accent); letter-spacing: 3px; }
        .status { font-size: 10px; color: #555; }

        #chat { flex: 1; padding: 25px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; scrollbar-width: thin; scrollbar-color: #333 transparent; }
        .msg { padding: 14px 18px; border-radius: 8px; max-width: 85%; line-height: 1.6; font-size: 14px; animation: slide 0.2s ease-out; }
        @keyframes slide { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        
        .u { background: #1c1c22; align-self: flex-end; border-right: 3px solid var(--accent); color: #fff; }
        .a { background: #16161a; align-self: flex-start; border-left: 3px solid var(--accent); position: relative; }
        
        /* Kod AlanÄ± */
        pre { background: #000; padding: 15px; border-radius: 5px; overflow-x: auto; margin: 10px 0; border: 1px solid #333; }
        code { color: #82aaff; }
        .copy-btn { position: absolute; top: 10px; right: 10px; background: var(--accent); color: #000; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 10px; font-weight: bold; }

        .controls { padding: 20px; background: #1a1a1e; display: flex; gap: 10px; }
        input { flex: 1; background: #000; border: 1px solid #333; padding: 12px; color: var(--accent); border-radius: 5px; outline: none; }
        .btn { padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-send { background: var(--accent); color: #000; }
        .btn-mic { background: #222; color: #fff; font-size: 1.2rem; }
        .mic-active { background: var(--error) !important; box-shadow: 0 0 15px var(--error); }
    </style>
</head>
<body>

<div id="app">
    <div class="header">
        <h2>HALVIOR_AI // CODER_EDITION</h2>
        <div class="status">V5.0_STABLE</div>
    </div>
    <div id="chat"></div>
    <div class="controls">
        <button id="mic" class="btn btn-mic" onclick="listen()">ðŸŽ¤</button>
        <input type="text" id="inp" placeholder="Kod iste veya bir ÅŸey sor..." onkeypress="if(event.key=='Enter') execute()">
        <button class="btn btn-send" onclick="execute()">RUN</button>
    </div>
</div>

<script>
    const chat = document.getElementById("chat");
    const inp = document.getElementById("inp");
    let lastInput = "";
    let spamCount = 0;

    const codeVault = {
        "html": "<!DOCTYPE html>\n<html>\n<body>\n <h1>Halvior AI</h1>\n <p>Kod basarÄ±yla olusturuldu.</p>\n</body>\n</html>",
        "css": "body {\n background: #000;\n color: #0f0;\n font-family: monospace;\n}",
        "js": "function helloWorld() {\n  console.log('Halvior AI aktif!');\n  alert('Merhaba DÃ¼nya');\n}",
        "flex": "display: flex;\njustify-content: center;\nalign-items: center;",
        "button": "<button style='background:#00ff9d; color:#000; border:none; padding:10px;'>Halvior Buton</button>",
        "form": "<form>\n <input type='text' placeholder='AdÄ±nÄ±z'>\n <button type='submit'>GÃ¶nder</button>\n</form>"
    };

    function speak(txt) {
        window.speechSynthesis.cancel();
        const s = new SpeechSynthesisUtterance(txt);
        s.lang = 'tr-TR';
        window.speechSynthesis.speak(s);
    }

    function listen() {
        if (!('webkitSpeechRecognition' in window)) return alert("TarayÄ±cÄ± desteklemiyor.");
        const r = new webkitSpeechRecognition();
        r.lang = 'tr-TR';
        r.onstart = () => document.getElementById("mic").classList.add("mic-active");
        r.onend = () => document.getElementById("mic").classList.remove("mic-active");
        r.onresult = (e) => { inp.value = e.results[0][0].transcript; execute(); };
        r.start();
    }

    async function execute() {
        const val = inp.value.trim();
        if (!val) return;

        // --- ANTI-SPAM LOGIC ---
        if(val.toLowerCase() === lastInput.toLowerCase()) {
            spamCount++;
            if(spamCount >= 2) {
                addMsg("SPAM TESPÄ°T EDÄ°LDÄ°: AynÄ± komutu tekrarlamayÄ± bÄ±rak knk.", 'a');
                speak("Spam yapma knk.");
                return;
            }
        } else {
            spamCount = 0;
            lastInput = val;
        }

        addMsg(val, 'u');
        inp.value = "";

        const low = val.toLowerCase();

        // --- CODER LOGIC ---
        let codeFound = false;
        for (let key in codeVault) {
            if (low.includes(key) && (low.includes("kod") || low.includes("yaz"))) {
                addCode(key.toUpperCase(), codeVault[key]);
                speak(`${key} kodu hazÄ±rlandÄ±.`);
                codeFound = true;
                break;
            }
        }
        if (codeFound) return;

        // --- NORMAL CHAT & WIKI ---
        if (low.includes("selam") || low.includes("merhaba")) {
            addMsg("Selam! Ben Halvior, kod kÃ¼tÃ¼phanem ve internet eriÅŸimimle emrindeyim.", 'a');
            speak("Selam dostum.");
        } else if (low.includes("nedir") || low.includes("kim")) {
            const q = low.replace("nedir","").replace("kim","").trim();
            addMsg("Halvior veritabanÄ±nda sorgulanÄ±yor...", 'a');
            const data = await fetch(`https://tr.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(q)}`).then(r => r.json());
            updateLast(data.extract || "Veri bulunamadÄ±.");
            speak(data.extract ? "Ä°stediÄŸin bilgiyi buldum." : "Bunu bilmiyorum.");
        } else {
            addMsg("AnlaÅŸÄ±lamayan komut. Kod yazdÄ±rmak iÃ§in 'html kod yaz' gibi bir ÅŸey dene.", 'a');
        }
    }

    function addMsg(t, c) {
        const d = document.createElement("div");
        d.className = `msg ${c}`;
        d.innerHTML = t;
        chat.appendChild(d);
        chat.scrollTop = chat.scrollHeight;
    }

    function addCode(title, code) {
        const d = document.createElement("div");
        d.className = "msg a";
        d.innerHTML = `<strong>${title} Kaynak Kodu:</strong><pre><button class="copy-btn" onclick="copy(this)">KOPYALA</button><code>${code.replace(/</g,"&lt;").replace(/>/g,"&gt;")}</code></pre>`;
        chat.appendChild(d);
        chat.scrollTop = chat.scrollHeight;
    }

    function updateLast(t) {
        const bots = document.querySelectorAll(".a");
        bots[bots.length - 1].innerText = t;
        chat.scrollTop = chat.scrollHeight;
    }

    function copy(btn) {
        navigator.clipboard.writeText(btn.nextElementSibling.innerText);
        btn.innerText = "ALINDI!";
        setTimeout(() => btn.innerText = "KOPYALA", 2000);
    }

    window.onload = () => addMsg("<b>HALVIOR_AI // SÄ°STEM_AKTÄ°F.</b><br>Bana 'html kod yaz' veya 'flex nedir' diye sorabilirsin.", 'a');
</script>

</body>
</html>
