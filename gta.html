<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Mini GTA Vice City — FULL</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
body{
    margin:0;overflow:hidden;
    background:linear-gradient(#12004d,#000);
}
#game{
    position:relative;width:100vw;height:100vh;overflow:hidden;
}

/* ROAD */
#road{
    position:absolute;left:0;top:-100%;
    width:100%;height:200%;
    background:repeating-linear-gradient(
        #1f1f1f 0px,#1f1f1f 40px,#2a2a2a 40px,#2a2a2a 80px
    );
    animation:road 1s linear infinite;
}
@keyframes road{from{top:-100%}to{top:0}}

/* PALMS */
.palm{
    position:absolute;bottom:0;width:40px;height:120px;
    background:linear-gradient(#2b8a3e,#0b3d1f);
    border-radius:8px 8px 0 0;opacity:.6
}
.palm:before{
    content:"";position:absolute;top:-30px;left:-20px;
    width:80px;height:30px;border-radius:50%;
    background:radial-gradient(circle,#2ecc71,#0b3d1f);
}

/* PLAYER */
.car{
    width:50px;height:90px;border-radius:8px;
    background:#ff2f92;box-shadow:0 0 18px #ff2f92;
    position:absolute;bottom:28px;left:50%;transform:translateX(-50%);
}

/* ENEMIES */
.enemy{
    width:50px;height:90px;border-radius:8px;
    background:#f5f5f5;position:absolute;top:-120px;
}
.police{
    background:#19c7ff;box-shadow:0 0 14px #19c7ff;
}

/* HUD */
#hud{
    position:absolute;top:12px;left:12px;z-index:10;
    color:#7fffe6;font-size:16px;line-height:1.4
}
#hud b{color:#00ffd0}
#nitroBar{
    width:120px;height:8px;background:#1b1b1b;border-radius:6px;margin-top:6px;
    overflow:hidden
}
#nitroFill{
    height:100%;width:100%;background:#ff9f1a
}

/* MOBILE CONTROLS */
#mobile{
    position:absolute;bottom:16px;left:50%;transform:translateX(-50%);
    display:flex;gap:14px;z-index:20
}
.mbtn{
    width:64px;height:64px;border-radius:50%;
    background:rgba(255,255,255,.12);
    color:#fff;font-size:22px;display:flex;align-items:center;justify-content:center;
    user-select:none
}
.mbtn:active{transform:scale(.95)}

/* GAME OVER */
#over{
    position:absolute;inset:0;background:rgba(0,0,0,.85);
    display:none;align-items:center;justify-content:center;flex-direction:column;
    color:#fff;font-size:28px;z-index:30
}
#over small{opacity:.7;margin-top:6px}
</style>
</head>

<body>
<div id="game">
    <div id="road"></div>

    <!-- palms -->
    <div class="palm" style="left:6%"></div>
    <div class="palm" style="left:88%"></div>

    <div class="car" id="player"></div>

    <div id="hud">
        Skor: <b id="score">0</b><br>
        Seviye: <b id="level">1</b><br>
        Rekor: <b id="best">0</b>
        <div id="nitroBar"><div id="nitroFill"></div></div>
    </div>

    <div id="mobile">
        <div class="mbtn" id="left">◀</div>
        <div class="mbtn" id="nitro">⚡</div>
        <div class="mbtn" id="right">▶</div>
    </div>

    <div id="over">
        GAME OVER
        <small>Yenile → devam</small>
    </div>
</div>

<script>
/* STATE */
const game=document.getElementById("game");
const player=document.getElementById("player");
const scoreEl=document.getElementById("score");
const levelEl=document.getElementById("level");
const bestEl=document.getElementById("best");
const nitroFill=document.getElementById("nitroFill");
const over=document.getElementById("over");

let x=innerWidth/2-25, score=0, level=1, speed=4;
let nitro=100, nitroOn=false, dead=false;

const BEST_KEY="gta_best";
bestEl.textContent=localStorage.getItem(BEST_KEY)||0;

/* MUSIC (user gesture needed) */
let music;
function startMusic(){
    if(music) return;
    music=new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_4b2e6e9e7c.mp3?filename=retro-funk-11254.mp3");
    music.loop=true; music.volume=.4; music.play().catch(()=>{});
}
document.addEventListener("click",startMusic,{once:true});

/* INPUT */
document.addEventListener("keydown",e=>{
    if(dead) return;
    if(e.key==="ArrowLeft") x-=24;
    if(e.key==="ArrowRight") x+=24;
    if(e.code==="Space") nitroOn=true;
});
document.addEventListener("keyup",e=>{
    if(e.code==="Space") nitroOn=false;
});
["left","right","nitro"].forEach(id=>{
    const el=document.getElementById(id);
    el.addEventListener("touchstart",e=>{
        e.preventDefault();
        if(id==="left") x-=24;
        if(id==="right") x+=24;
        if(id==="nitro") nitroOn=true;
    });
    el.addEventListener("touchend",()=>{ if(id==="nitro") nitroOn=false; });
});

/* LOOP HELPERS */
function clamp(){ x=Math.max(0,Math.min(innerWidth-50,x)); player.style.left=x+"px"; }
setInterval(clamp,16);

function spawnEnemy(){
    if(dead) return;
    const e=document.createElement("div");
    e.className=Math.random()>.6?"enemy police":"enemy";
    e.style.left=Math.random()*(innerWidth-50)+"px";
    game.appendChild(e);
    let y=-120;
    const t=setInterval(()=>{
        if(dead){clearInterval(t);e.remove();return;}
        let v=speed+(nitroOn&&nitro>0?3:0);
        y+=v; e.style.top=y+"px";

        // collision
        const p=player.getBoundingClientRect(), n=e.getBoundingClientRect();
        if(p.left<n.right&&p.right>n.left&&p.top<n.bottom&&p.bottom>n.top){
            dead=true; over.style.display="flex";
            localStorage.setItem(BEST_KEY,Math.max(+bestEl.textContent,score));
        }
        if(y>innerHeight){
            clearInterval(t); e.remove();
            score++; scoreEl.textContent=score;
            if(score%10===0){ level++; levelEl.textContent=level; speed++; }
        }
    },20);
}

/* NITRO */
setInterval(()=>{
    if(nitroOn && nitro>0){ nitro-=2; }
    else nitro=Math.min(100,nitro+.6);
    nitroFill.style.width=nitro+"%";
},50);

/* SPAWNER */
setInterval(spawnEnemy,900);
</script>
</body>
</html>
