<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>RDR 2D: Halvior Ultimate</title>
    <style>
        body { margin: 0; overflow: hidden; background: #3d2b1f; font-family: 'Georgia', serif; }
        #arayuz { position: absolute; top: 20px; left: 20px; color: #f4a460; background: rgba(30, 15, 0, 0.9); padding: 15px; border: 3px double #8b4513; border-radius: 5px; pointer-events: none; min-width: 200px; box-shadow: 5px 5px 15px #000; }
        #alt-yazi { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); width: 60%; background: rgba(0,0,0,0.8); color: #fff; padding: 20px; border-top: 5px solid #ffcc00; display: none; text-align: center; font-size: 1.2em; border-radius: 10px; }
        #onur-bar { width: 100%; height: 10px; background: #555; margin-top: 5px; border: 1px solid #fff; }
        #onur-seviye { width: 50%; height: 100%; background: linear-gradient(to right, #8b0000, #ffffff, #00008b); transition: 0.5s; }
        canvas { display: block; filter: sepia(0.4) contrast(1.1); }
    </style>
</head>
<body>

<div id="arayuz">
    <div style="font-size: 20px; font-weight: bold; color: #ffcc00;">HALVIOR: KANUNSUZ</div>
    üí∞ Altƒ±n: $<span id="para">150.00</span><br>
    ‚ù§Ô∏è Saƒülƒ±k: <span id="can">100</span><br>
    ‚öñÔ∏è ONUR: <div id="onur-bar"><div id="onur-seviye"></div></div>
    ‚≠ê Aranƒ±yor: <span id="aranma">TEMƒ∞Z</span>
    <hr>
    <div id="gorev" style="color: #0f0;">G√ñREV: ≈ûerifle konu≈ü veya avlan.</div>
</div>

<div id="alt-yazi"></div>

<canvas id="oyun"></canvas>

<script>
    const canvas = document.getElementById('oyun');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // --- OYUN AYARLARI ---
    let oyuncu = { x: 1000, y: 1000, aci: 0, atUst√ºnde: false, can: 100, para: 150, onur: 50, aranma: 0 };
    let kamera = { x: 0, y: 0 };
    let fare = { x: 0, y: 0 };
    let mermiler = [];
    let tuslar = {};

    // --- D√úNYA ELEMENTLERƒ∞ ---
    const binalar = [
        { x: 800, y: 700, w: 250, h: 300, isim: "SALOON", renk: "#4e342e" },
        { x: 1300, y: 800, w: 200, h: 200, isim: "≈ûERƒ∞F", renk: "#3e2723" },
        { x: 500, y: 500, w: 150, h: 150, isim: "MARKET", renk: "#5d4037" }
    ];

    let at = { x: 1100, y: 1100, can: 150, hiz: 0 };

    let npcler = [
        { x: 1350, y: 850, isim: "Dutch", renk: "red", diyalog: "Sadece biraz daha para Arthur, sonra Tahitiii!", tip: "dost" },
        { x: 1400, y: 950, isim: "≈ûerif", renk: "blue", diyalog: "G√∂z√ºm √ºzerinde Halvior, uslu dur.", tip: "dost" },
        { x: 1200, y: 1500, isim: "O'Driscoll", renk: "orange", diyalog: "√ñleceksin kovboy!", tip: "dusman", can: 50 }
    ];

    let hayvanlar = [
        { x: 600, y: 600, tip: "Geyik", can: 20, oldu: false },
        { x: 1500, y: 1200, tip: "Bizon", can: 50, oldu: false }
    ];

    // --- KONTROLLER ---
    window.onmousemove = (e) => { fare.x = e.clientX + kamera.x; fare.y = e.clientY + kamera.y; };
    window.onmousedown = () => { if(!oyuncu.atUst√ºnde) atesEt(); };
    window.onkeydown = (e) => { 
        tuslar[e.code] = true;
        if(e.code === 'KeyF') etkilesim();
        if(e.code === 'KeyE') atBinIn();
    };
    window.onkeyup = (e) => tuslar[e.code] = false;

    function atBinIn() {
        let d = Math.hypot(oyuncu.x - at.x, oyuncu.y - at.y);
        if(d < 70) oyuncu.atUst√ºnde = !oyuncu.atUst√ºnde;
    }

    function atesEt() {
        let aci = Math.atan2(fare.y - oyuncu.y, fare.x - oyuncu.x);
        mermiler.push({ x: oyuncu.x, y: oyuncu.y, vx: Math.cos(aci)*20, vy: Math.sin(aci)*20, sahip: "oyuncu" });
    }

    function etkilesim() {
        const box = document.getElementById('alt-yazi');
        let d = 100;
        let mesaj = "Halvior: 'Racon bitti, i≈üine bak!'";

        npcler.forEach(n => {
            if(Math.hypot(oyuncu.x - n.x, oyuncu.y - n.y) < 70) {
                mesaj = n.isim + ": '" + n.diyalog + "'";
                oyuncu.onur += 2; // Selamla≈ümak onur verir
            }
        });

        box.innerText = mesaj;
        box.style.display = 'block';
        setTimeout(() => box.style.display = 'none', 3000);
        guncelleUI();
    }

    function guncelleUI() {
        document.getElementById('para').innerText = oyuncu.para.toFixed(2);
        document.getElementById('onur-seviye').style.width = oyuncu.onur + "%";
        document.getElementById('aranma').innerText = oyuncu.aranma > 0 ? "ARANIYOR ‚≠êÔ∏è" : "TEMƒ∞Z";
        document.getElementById('can').innerText = Math.ceil(oyuncu.can);
    }

    // --- √áƒ∞Zƒ∞M FONKSƒ∞YONLARI ---
    function cizKovboy(x, y, aci, renk, isim) {
        ctx.save();
        ctx.translate(x, y);
        ctx.rotate(aci);
        ctx.fillStyle = renk; ctx.fillRect(-15, -15, 30, 30); // V√ºcut
        ctx.fillStyle = "#000"; ctx.fillRect(-20, -18, 40, 6); // ≈ûapka
        ctx.fillStyle = "#fff"; ctx.fillRect(10, -10, 5, 5); ctx.fillRect(10, 5, 5, 5); // G√∂zler
        ctx.restore();
        ctx.fillStyle = "white"; ctx.fillText(isim, x - 20, y - 25);
    }

    function dongu() {
        ctx.setTransform(1,0,0,1,0,0);
        ctx.fillStyle = "#c2a385"; ctx.fillRect(0, 0, canvas.width, canvas.height); // Toprak zemin
        ctx.translate(-kamera.x, -kamera.y);

        // Binalar
        binalar.forEach(b => {
            ctx.fillStyle = b.renk; ctx.fillRect(b.x, b.y, b.w, b.h);
            ctx.strokeStyle = "#222"; ctx.lineWidth = 5; ctx.strokeRect(b.x, b.y, b.w, b.h);
            ctx.fillStyle = "yellow"; ctx.fillRect(b.x+20, b.y+40, 30, 30); // Pencere
        });

        // Hayvanlar
        hayvanlar.forEach(h => {
            if(!h.oldu) {
                ctx.fillStyle = "#5d4037"; ctx.beginPath(); ctx.arc(h.x, h.y, 20, 0, 7); ctx.fill();
                ctx.fillStyle = "white"; ctx.fillText(h.tip, h.x - 15, h.y - 25);
            }
        });

        // At
        ctx.fillStyle = "#6d4c41"; ctx.fillRect(at.x - 40, at.y - 20, 80, 40);
        ctx.fillStyle = "#3e2723"; ctx.fillRect(at.x + 30, at.y - 15, 20, 15); // Kafa

        // Oyuncu ve NPC'ler
        npcler.forEach(n => {
            if(n.can === undefined || n.can > 0)
                cizKovboy(n.x, n.y, 0, n.renk, n.isim);
        });

        if(!oyuncu.atUst√ºnde) {
            oyuncu.aci = Math.atan2(fare.y - oyuncu.y, fare.x - oyuncu.x);
            cizKovboy(oyuncu.x, oyuncu.y, oyuncu.aci, "#2196f3", "HALVIOR");
        } else {
            at.x = oyuncu.x; at.y = oyuncu.y;
        }

        // Mermiler ve √áarpƒ±≈üma
        mermiler.forEach((m, i) => {
            m.x += m.vx; m.y += m.vy;
            ctx.fillStyle = "yellow"; ctx.fillRect(m.x, m.y, 10, 4);

            // Hayvan vurma
            hayvanlar.forEach(h => {
                if(!h.oldu && Math.hypot(m.x - h.x, m.y - h.y) < 30) {
                    h.oldu = true; oyuncu.para += 20; mermiler.splice(i, 1);
                }
            });

            // NPC vurma (Su√ß)
            npcler.forEach(n => {
                if(Math.hypot(m.x - n.x, m.y - n.y) < 30) {
                    oyuncu.onur -= 10; oyuncu.aranma = 1; mermiler.splice(i, 1);
                }
            });
        });

        // Hareket ve Kamera
        let hiz = oyuncu.atUst√ºnde ? 10 : 5;
        if(tuslar['KeyW']) oyuncu.y -= hiz;
        if(tuslar['KeyS']) oyuncu.y += hiz;
        if(tuslar['KeyA']) oyuncu.x -= hiz;
        if(tuslar['KeyD']) oyuncu.x += hiz;

        kamera.x = oyuncu.x - canvas.width/2;
        kamera.y = oyuncu.y - canvas.height/2;

        guncelleUI();
        requestAnimationFrame(dongu);
    }
    dongu();
</script>
</body>
</html>
